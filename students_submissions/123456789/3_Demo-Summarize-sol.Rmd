---
title: "PROG8430-Demo-Summarize"
author: "Peiyuan"
date: "05/26/2023"
output: pdf_document
---
NOTE: Comments are included for you to help you understand the code. 
In your submission it needs to be changed to your understanding of the steps you are taking.                         
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This section is for the basic set up.
It will clear all the plots, the console and the workspace.
It also sets the overall format for numbers.
```{r}
if(!is.null(dev.list())) dev.off() #checks if any graphical devices are open, if yes, close them
cat("\014") #clearing the console and starting on a new page
rm(list=ls()) #This line removes all objects from the workspace
options(scipen=9)
```

This section loads and attaches all the necessary packages.
```{r}
#Load packages
#For Excel
if(!require(readxl)){install.packages("readxl")}
library("readxl")
```


This section reads in the Excel file and renames columns
```{r}
getwd()  # Verify current working directory
Elect08_DAMA <- read_excel("Data/Elect2008.xlsx")
Elect08_DAMA <- as.data.frame(Elect08_DAMA)
#Elect08_DAMA <- read.csv(file = 'Elect2008.csv')
head(Elect08_DAMA) #output 6*16 data.frame

#Drop first column
Elect08_DAMA <- Elect08_DAMA[ ,-c(1)] #2:16  
#[,-c(1)] is a subsetting operation that selects all rows and all columns except for the first column

#Append suffix "_DAMA" initials to each column of Elect08_DAMA
colnames(Elect08_DAMA) <- paste(colnames(Elect08_DAMA), "DAMA", sep = "_")
#combines each existing column name with the string "DAMA" using an underscore as the separator. 
head(Elect08_DAMA,10) #output 10*15 data.frame

#convert data from a character or factor data type to a numeric data type (dbl=double).
Elect08_DAMA$Turnout_DAMA <- as.numeric(Elect08_DAMA$Turnout_DAMA) 
head(Elect08_DAMA,10) #output 6*15 data.frame
```

Creates central tendancy measures
```{r}
#Dataset Structure
dim(Elect08_DAMA) # dimensions of the data set 51rows * 15 columns
str(Elect08_DAMA) # Display the structure of the file
##################################################
### Measures of Central Tendency                ##
##################################################
mean(Elect08_DAMA$Obama_DAMA) #51.28941
round(mean(Elect08_DAMA$Obama_DAMA),2) #51.29
mean(Elect08_DAMA$Obama_DAMA, trim=0.1) #50.81317
#it trims the top and bottom 10%(0.1) of values before calculating the mean.
median(Elect08_DAMA$Obama_DAMA) #51.38
weighted.mean(Elect08_DAMA$Obama_DAMA, w=Elect08_DAMA$Population_DAMA) #52.68575
#calculate the weighted mean of a numeric vector or column, the weight refer to the column "population"
```
Answers and interpretation should go here.
 
 

Measures of Dispersion
```{r}
##################################################
### Measures of Dispersion                      ##
##################################################
var(Elect08_DAMA$Obama_DAMA)   # variance (123.0723)
sd(Elect08_DAMA$Obama_DAMA)    # standard deviation (11.0938)
range(Elect08_DAMA$Obama_DAMA) # min=32.54 max=92.46
max(Elect08_DAMA$Obama_DAMA)-min(Elect08_DAMA$Obama_DAMA) #59.92

quantile(Elect08_DAMA$Obama_DAMA) # 0%, 25%, 50%, 75%, 100%
quantile(Elect08_DAMA$Obama_DAMA, c(.41, .52, .93)) 
IQR(Elect08_DAMA$Obama_DAMA) # 57.335(75%)-42.755(25%)

summary(Elect08_DAMA$Obama_DAMA)
summary(Elect08_DAMA)
```
 

Coefficient of Variation
```{r}
##################################################
### Coefficient of Variation                    ##
##################################################
mo <- mean(Elect08_DAMA$Obama_DAMA)
so <- sd(Elect08_DAMA$Obama_DAMA)

cvo <- so/mo
round(cvo,2)
```
 

Create a table
```{r}
##################################################
### Create Tables                               ##
##################################################
#Create a Variable to see if Obama won a State
Elect08_DAMA$Win_DAMA <- "M" #default setting for "Win" is "M" (McCain)
head(Elect08_DAMA) #output 6*16 data.frame

Elect08_DAMA$Win_DAMA <- with(Elect08_DAMA, ifelse(Obama_DAMA > McCain_DAMA, "O", Win_DAMA))
#if the values in the Obama_DAMA column are greater than the values in the McCain_DAMA column, the value "O" is assigned;
str(Elect08_DAMA)
head(Elect08_DAMA) #output 6*16 data.frame

Elect08_DAMA$Win_DAMA <- as.factor(Elect08_DAMA$Win_DAMA)
str(Elect08_DAMA)
head(Elect08_DAMA) #output 6*16 data.frame
```


Cross Tabulation
```{r}
#Frequency Table
Table2 <- table(Elect08_DAMA$Region_DAMA, Elect08_DAMA$Win_DAMA) 
#table() function is used to create a frequency table of categorical data
#Table 2 shows the frequency counts of the combinations of values between the Region_DAMA and Win_DAMA variables
Table2 #Table 2 will show the frequency count of observations in each combination of categories

margin.table(Table2, 1) # A frequencies (summed over B) Marginal function for each row
margin.table(Table2, 2) # B frequencies (summed over A) Marginal function for each column

prop.table(Table2) # cell percentages
prop.table(Table2, 1) # percentages by row
prop.table(Table2, 2) # percentages by column
```
Interpretation should go here.
 
 
Calculate values in tables
```{r}
#States Obama won above a certain amount
Elect08_DAMA[Elect08_DAMA$Obama_DAMA > 65, c("State_DAMA", "Unemployment_DAMA", "Income_DAMA", "Obama_DAMA")]
#select columns based on a condition.

#Aggregate/counting all Percentage Won by Region
Table1 <- aggregate(Elect08_DAMA[,3:4], by=list(Elect08_DAMA$Region_DAMA), FUN=mean, na.rm=TRUE) 
#select "Obama_DAMA" and "McCain_DAMA" columns, group them by "region_DAMA", and calculate the mean for each group and ignore the missing values (NA).  
Table1
```


Histogram
```{r}
#################################################
### Histogram                                  ##
#################################################
hist(Elect08_DAMA$Obama_DAMA,
     col= 2,
     xlab="Support for Obama",
     main="Histogram of Support for Obama")
```

Interpretation: Which range(s) have the most support for Obama?
The range is between 40 and 50.



Box Plot
```{r}
#################################################
### Box Plots                                  ##
#################################################
#Box Plot of McCain Support 
boxplot(Elect08_DAMA$McCain_DAMA, 
        main="Distribution of McCain Support",
        xlab="Percent of McCain Support",
        col=5,
        horizontal=TRUE,
        pch=20)

#Comparing by Regions
boxplot(McCain_DAMA ~ Region_DAMA,
        data=Elect08_DAMA,
        main="Distribution of McCain Support by Region",
        xlab="Regions",
        col=4,
        pch = 20)
```


Scatter Plot!
```{r}
##############################################
### Scatter Plots                           ##
##############################################
# Basic chart
plot(Unemployment_DAMA ~ Income_DAMA,
     data=Elect08_DAMA,
     main="Unemployment by Income, 2008")

#You can change some formatting
plot(Unemployment_DAMA ~ Income_DAMA,
     data=Elect08_DAMA,
     col=6,
     pch=4,
     main="Turnout by Income, 2008",
     xlab="Income",
     ylab="Unemployment Rate")
abline(coef = c(6,0)) #overlays a line, intercept=6, slope=0
```


Correlation Coefficient
```{r}

#str(Elect08_DAMA)
print("Pearson Correlation")
cor(Elect08_DAMA$Unemployment_DAMA, Elect08_DAMA$Income_DAMA)

#Pearson defaults, but assumes normality
print("Spearman Correlation")
cor(Elect08_DAMA$Unemployment_DAMA, Elect08_DAMA$Income_DAMA, method="spearman")
```